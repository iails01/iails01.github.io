<!DOCTYPE html>
<html>
  <!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="robots" content="noindex">
  
  <title>Haskell 表达式、函数、模块 - Iails&#39;s posts</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
  
  <meta name="keywords" content=>
  
    <meta name="description" content="The Personal blog of Iails, a programer.">
  
  
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=1.02">
  
  

  
<link rel="stylesheet" href="/css/style.css">

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-shiki-plugin@latest/lib/codeblock.css">
<style>:root{--hl-color:#abb2bf;--hl-bg:#282c34;--hltools-bg:#21252b;--hltools-color:#bbbbbc;--hlnumber-bg:#282c34;--hlnumber-color:#495162;--hlscrollbar-bg:#373c47;--hlexpand-bg:linear-gradient(180deg,rgba(40,44,52,0.1),rgba(40,44,52,0.9))}</style>
    <style>
    .code-expand-btn:not(.expand-done) ~ div.codeblock,
    .code-expand-btn:not(.expand-done) ~ * div.codeblock {
      overflow: hidden;
      height: 360px;
    }
    </style>
  <!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.2.0"></head>
  <body>
    <div class="container">
      <header class="header">
  <div class="blog-title">
    <a href="/" class="logo">♪</a>
    <div class="subtitle"></div>
  </div>
  <nav class="navbar">
    <ul class="menu">
      
        <li class="menu-item">
          <a href="/" class="menu-item-link">Home</a>
        </li>
      
    </ul>
  </nav>
</header>
<article class="post">
  <div class="post-title">
    <h1 class="article-title">Haskell 表达式、函数、模块</h1>
  </div>
   <div class="post-meta" style="color:#000000;font-size:16px;">
    <span class="post-time">2024-06-01</span> <br>
  </div>
  <div class="post-content">
    <p><a target="_blank" rel="noopener" href="https://learnyoua.haskell.sg/zh-cn/ch02/ready-go">https://learnyoua.haskell.sg/zh-cn/ch02/ready-go</a><br><a target="_blank" rel="noopener" href="http://cnhaskell.com/chp/1.html">http://cnhaskell.com/chp/1.html</a></p>
<p>语法格式：<a target="_blank" rel="noopener" href="https://www.haskell.org/onlinereport/haskell2010/haskellch10.html#x17-18000010.5">https://www.haskell.org/onlinereport/haskell2010/haskellch10.html#x17-18000010.5</a></p>
<p>doc: <code>Haskell Platform\8.6.5\doc</code>、<a target="_blank" rel="noopener" href="http://hackage.haskell.org/package/ghc-prim-0.5.3/docs/doc-index.html">http://hackage.haskell.org/package/ghc-prim-0.5.3/docs/doc-index.html</a></p>
<h3 id="缩进"><a href="#缩进" class="headerlink" title="缩进"></a>缩进</h3><ul>
<li><code>where</code>所在行的下一行代码的缩进记为<code>A</code>，那么此后的所有行的缩进都应该满足<code>&gt;A</code></li>
<li><code>函数定义</code>：函数f的定义第一行的缩进记为<code>A</code>，那么在对f的定义中，所有行的缩进都应该满足<code>&gt;A</code></li>
<li>在一些情况下可以使用<code>;</code>来替代换行<code>f :: Num a =&gt; a-&gt;a; f x = x</code>,<code>case x of Nothing -&gt; 0; Just _ -&gt; 1</code></li>
</ul>
<h3 id="列表生成式"><a href="#列表生成式" class="headerlink" title="列表生成式"></a>列表生成式</h3><blockquote>
<p>是一个语法糖，实际是使用的递归和模式匹配来遍历列表</p>
</blockquote>
<figure class="shiki haskell"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div><div class="code"><pre class="shiki one-dark-pro"><code><span class="line"><span style="color: #ABB2BF"># 定义 迭代 过滤 的顺序与个数无要求</span></span>
<span class="line"><span style="color: #ABB2BF">l = [&lt;exp&gt; | (&lt;定义&gt;|&lt;迭代&gt;|&lt;过滤&gt;,)?]</span></span></code></pre></div></div></figure>

<ul>
<li><code>定义</code>：<code>let (&lt;name&gt; = &lt;value&gt;;)*</code>，同一个let中不能出现相同的name，不同的定义可以出现相同的name，后面的覆盖前面的，没有<code>in</code>，不是<code>let</code>表达式，但是<code>let</code>是必须的。</li>
</ul>
<p>let定义的值在子生成式中也可见</p>
<figure class="shiki haskell"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki one-dark-pro"><code><span class="line"><span style="color: #ABB2BF">[x | </span><span style="color: #C678DD">let</span><span style="color: #ABB2BF"> a = </span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">, x &lt;- [ y | </span><span style="color: #C678DD">let</span><span style="color: #ABB2BF"> y = a]] </span><span style="color: #7F848E; font-style: italic">-- [1]</span></span></code></pre></div></div></figure>

<ul>
<li><code>迭代</code>：<code>x &lt;- xs</code>，如果没有<code>&lt;迭代&gt;</code>那么只有一个元素，如果有<code>&lt;迭代&gt;</code>那么会以笛卡尔积的形式重复：</li>
</ul>
<figure class="shiki haskell"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki one-dark-pro"><code><span class="line"><span style="color: #ABB2BF">[ (a, b) | a &lt;- [</span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">..</span><span style="color: #D19A66">2</span><span style="color: #ABB2BF">], b &lt;- [</span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">..</span><span style="color: #D19A66">3</span><span style="color: #ABB2BF">] ] </span><span style="color: #7F848E; font-style: italic">-- [(1,1),(1,2),(1,3),(2,1),(2,2),(2,3)]</span></span></code></pre></div></div></figure>

<ul>
<li><code>过滤</code>：<code>x &gt; 1</code>，所有的过滤条件都为True值才会出现在结果中</li>
</ul>
<figure class="shiki haskell"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki one-dark-pro"><code><span class="line"><span style="color: #ABB2BF">l = [ x | </span><span style="color: #C678DD">let</span><span style="color: #ABB2BF"> xs = [</span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">,</span><span style="color: #D19A66">2</span><span style="color: #ABB2BF">,</span><span style="color: #D19A66">3</span><span style="color: #ABB2BF">], x &lt;- xs, x &gt; </span><span style="color: #D19A66">1</span><span style="color: #ABB2BF"> ]</span></span></code></pre></div></div></figure>

<ul>
<li>取值时是从左到右的：</li>
</ul>
<figure class="shiki haskell"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div><div class="code"><pre class="shiki one-dark-pro"><code><span class="line"><span style="color: #ABB2BF">[ x | </span><span style="color: #C678DD">let</span><span style="color: #ABB2BF"> xs = [</span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">,</span><span style="color: #D19A66">2</span><span style="color: #ABB2BF">,</span><span style="color: #D19A66">3</span><span style="color: #ABB2BF">], </span><span style="color: #C678DD">let</span><span style="color: #ABB2BF"> xs = [</span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">,</span><span style="color: #D19A66">2</span><span style="color: #ABB2BF">,</span><span style="color: #D19A66">3</span><span style="color: #ABB2BF">,</span><span style="color: #D19A66">4</span><span style="color: #ABB2BF">], x &lt;- xs, x &gt; </span><span style="color: #D19A66">1</span><span style="color: #ABB2BF"> ] </span><span style="color: #7F848E; font-style: italic">-- [2,3,4]</span></span>
<span class="line"><span style="color: #ABB2BF">[ x | </span><span style="color: #C678DD">let</span><span style="color: #ABB2BF"> xs = [</span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">,</span><span style="color: #D19A66">2</span><span style="color: #ABB2BF">,</span><span style="color: #D19A66">3</span><span style="color: #ABB2BF">], x &lt;- xs, </span><span style="color: #C678DD">let</span><span style="color: #ABB2BF"> xs = </span><span style="color: #D19A66">[]</span><span style="color: #ABB2BF">, x &gt; </span><span style="color: #D19A66">1</span><span style="color: #ABB2BF"> ] </span><span style="color: #7F848E; font-style: italic">-- [2,3]</span></span>
<span class="line"><span style="color: #ABB2BF">[ x*</span><span style="color: #D19A66">2</span><span style="color: #ABB2BF"> | </span><span style="color: #D19A66">False</span><span style="color: #ABB2BF">, x &lt;- [</span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">,</span><span style="color: #D19A66">2</span><span style="color: #ABB2BF">] ] </span><span style="color: #7F848E; font-style: italic">-- []</span></span></code></pre></div></div></figure>

<h3 id="underscore"><a href="#underscore" class="headerlink" title="underscore _"></a>underscore <code>_</code></h3><blockquote>
<p>doc: <a target="_blank" rel="noopener" href="https://typeclasses.com/underscore">https://typeclasses.com/underscore</a></p>
</blockquote>
<p>在某些地方单独出现时可以当作<code>通配符</code>或者<code>hole</code></p>
<ul>
<li>模式中: 通配符，代表不关心是什么值</li>
</ul>
<h3 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h3><p>本质上所有的函数都只有一个参数</p>
<p>函数内部可以使用外部量，但函数内的外部量会一直是函数定义时该量的值。也就是说Haskell中的量的作用域是词法作用域</p>
<h4 id="函数定义-调用"><a href="#函数定义-调用" class="headerlink" title="函数定义&#x2F;调用"></a>函数定义&#x2F;调用</h4><figure class="shiki"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div><div class="code"><pre class="shiki one-dark-pro"><code><span class="line"><span style="color: #abb2bf">&lt;函数名&gt; :: &lt;类型描述&gt;</span></span>
<span class="line"><span style="color: #abb2bf">&lt;前缀函数名&gt; &lt;value&gt;* = &lt;函数体&gt; // 函数体最后一个表达式的值就是返回值</span></span>
<span class="line"><span style="color: #abb2bf">&lt;value&gt; (`&lt;中缀函数名&gt;`|&lt;符号&gt;) &lt;value&gt;</span></span>
<span class="line"><span style="color: #abb2bf"></span></span>
<span class="line"><span style="color: #abb2bf">&lt;value&gt; :: 见type/data章节部分</span></span></code></pre></div></div></figure>

<p>函数的定义类似一个命题，定义了某个表达式的归约规则：</p>
<figure class="shiki haskell"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div><div class="code"><pre class="shiki one-dark-pro"><code><span class="line"><span style="color: #61AFEF">flip&#39;</span><span style="color: #ABB2BF"> :: (</span><span style="color: #C678DD">a</span><span style="color: #ABB2BF"> -&gt; </span><span style="color: #C678DD">b</span><span style="color: #ABB2BF"> -&gt; </span><span style="color: #C678DD">c</span><span style="color: #ABB2BF">) -&gt; </span><span style="color: #C678DD">b</span><span style="color: #ABB2BF"> -&gt; </span><span style="color: #C678DD">a</span><span style="color: #ABB2BF"> -&gt; </span><span style="color: #C678DD">c</span></span>
<span class="line"><span style="color: #7F848E; font-style: italic">-- flip&#39; f 替换为g，然后将 g x y 替换为 f y x</span></span>
<span class="line"><span style="color: #ABB2BF">flip&#39; f = g</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">where</span><span style="color: #ABB2BF"> g x y = f y x</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">-- 更简单的方法</span></span>
<span class="line"><span style="color: #61AFEF">flip&#39;</span><span style="color: #ABB2BF"> :: (</span><span style="color: #C678DD">a</span><span style="color: #ABB2BF"> -&gt; </span><span style="color: #C678DD">b</span><span style="color: #ABB2BF"> -&gt; </span><span style="color: #C678DD">c</span><span style="color: #ABB2BF">) -&gt; </span><span style="color: #C678DD">b</span><span style="color: #ABB2BF"> -&gt; </span><span style="color: #C678DD">a</span><span style="color: #ABB2BF"> -&gt; </span><span style="color: #C678DD">c</span><span style="color: #ABB2BF">  </span></span>
<span class="line"><span style="color: #7F848E; font-style: italic">-- 命题：flip&#39; f x y 的值等于 f y x 的值</span></span>
<span class="line"><span style="color: #ABB2BF">flip&#39; f x y = f y x</span></span></code></pre></div></div></figure>

<p>符号函数是中缀的，非符号函数是前缀的</p>
<p>中缀函数添加括号后变成前缀函数，前缀函数添加反引号后变成中缀函数。（但是不允许双重操作，即非符合函数添加反引号后变成中缀函数，然后又添加括号想变回前缀函数（此时表达式不合法！），反之亦不合法）</p>
<p>只有非符号函数才可以参与<code>运算</code>(规约)操作，符号函数只能参与函数调用操作（要参与运算必须添加括号）。因此当函数作为参数传递时只能是前缀式的</p>
<figure class="shiki haskell"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div><div class="code"><pre class="shiki one-dark-pro"><code><span class="line"><span style="color: #ABB2BF">f = / </span><span style="color: #7F848E; font-style: italic">-- /不能参与运算</span></span>
<span class="line"><span style="color: #ABB2BF">f = (</span><span style="color: #61AFEF">/</span><span style="color: #ABB2BF">) </span><span style="color: #7F848E; font-style: italic">-- ok</span></span></code></pre></div></div></figure>

<h5 id="定义函数"><a href="#定义函数" class="headerlink" title="定义函数"></a>定义函数</h5><figure class="shiki haskell"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div><div class="code"><pre class="shiki one-dark-pro"><code><span class="line"><span style="color: #ABB2BF">a *-= b = a - b</span></span>
<span class="line"><span style="color: #ABB2BF">(</span><span style="color: #61AFEF">*-=</span><span style="color: #ABB2BF">) a b = a - b</span></span>
<span class="line"><span style="color: #ABB2BF">f a b = a - b</span></span>
<span class="line"><span style="color: #ABB2BF">a `f` b = a - b</span></span></code></pre></div></div></figure>

<h5 id="调用函数"><a href="#调用函数" class="headerlink" title="调用函数"></a>调用函数</h5><figure class="shiki haskell"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div><div class="code"><pre class="shiki one-dark-pro"><code><span class="line"><span style="color: #ABB2BF">a *-= b</span></span>
<span class="line"><span style="color: #ABB2BF">(</span><span style="color: #61AFEF">*-=</span><span style="color: #ABB2BF">) a b</span></span>
<span class="line"><span style="color: #ABB2BF">f a b</span></span>
<span class="line"><span style="color: #ABB2BF">a `f` b</span></span></code></pre></div></div></figure>

<h5 id="函数部分调用"><a href="#函数部分调用" class="headerlink" title="函数部分调用"></a>函数部分调用</h5><ul>
<li>中缀方式，需要整体在外围添加括号。 中缀方式可以选择先传递第二个参数。</li>
</ul>
<figure class="shiki haskell"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div><div class="code"><pre class="shiki one-dark-pro"><code><span class="line"><span style="color: #ABB2BF">(/</span><span style="color: #D19A66">10</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">(</span><span style="color: #D19A66">10</span><span style="color: #ABB2BF">/)</span></span>
<span class="line"><span style="color: #ABB2BF">(`f` </span><span style="color: #D19A66">10</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">(</span><span style="color: #D19A66">2</span><span style="color: #ABB2BF"> `f`)</span></span></code></pre></div></div></figure>

<blockquote>
<p>函数<code>-</code>不能部分调用第二个参数(<code>-10</code>)，因为会被认为是负数，此时可以用<code>subtract</code>函数。<code>subtract n</code>返回一个把<code>参数的值</code>减去<code>n</code>的一个函数。<code>subtract 10 100 == 90</code><br>通过中缀方式传递参数，可以指定传递第一个还是第二个参数：第一个<code>(10/)</code>和第二个<code>(/10)</code>，任何函数都可以使用中缀方式调用，所以对于任意个数参数的函数总是可以跳过第一参数（好像没什么用？）</p>
<figure class="shiki haskell"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div><div class="code"><pre class="shiki one-dark-pro"><code><span class="line"><span style="color: #ABB2BF">f x y z = (x,y,z)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">fy = (`f` </span><span style="color: #98C379">&#39;y&#39;</span><span style="color: #ABB2BF">) </span><span style="color: #7F848E; font-style: italic">-- 跳过第一个参数，此时第三个参数变为第二个参数</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">fyz = (`fy` </span><span style="color: #98C379">&#39;z&#39;</span><span style="color: #ABB2BF">) </span><span style="color: #7F848E; font-style: italic">-- 继续跳过第一个参数</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">fyz </span><span style="color: #98C379">&#39;x&#39;</span><span style="color: #ABB2BF"> </span><span style="color: #7F848E; font-style: italic">-- (&#39;x&#39;,&#39;y&#39;,&#39;z&#39;)</span></span></code></pre></div></div></figure>
</blockquote>
<ul>
<li>前缀方式，直接按序给出参数即可</li>
</ul>
<figure class="shiki haskell"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki one-dark-pro"><code><span class="line"><span style="color: #ABB2BF">(</span><span style="color: #61AFEF">/</span><span style="color: #ABB2BF">) </span><span style="color: #D19A66">10</span></span></code></pre></div></div></figure>

<ul>
<li>函数部分调用后，参数类型约束会修改：</li>
</ul>
<figure class="shiki haskell"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div><div class="code"><pre class="shiki one-dark-pro"><code><span class="line"><span style="color: #61AFEF">compare</span><span style="color: #ABB2BF"> :: </span><span style="color: #D19A66">Ord</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">a</span><span style="color: #ABB2BF"> =&gt; </span><span style="color: #C678DD">a</span><span style="color: #ABB2BF"> -&gt; </span><span style="color: #C678DD">a</span><span style="color: #ABB2BF"> -&gt; </span><span style="color: #D19A66">Ordering</span></span>
<span class="line"><span style="color: #ABB2BF">compare </span><span style="color: #D19A66">1</span><span style="color: #ABB2BF"> :: (</span><span style="color: #D19A66">Ord</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">a</span><span style="color: #ABB2BF">, </span><span style="color: #D19A66">Num</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">a</span><span style="color: #ABB2BF">) =&gt; </span><span style="color: #C678DD">a</span><span style="color: #ABB2BF"> -&gt; </span><span style="color: #D19A66">Ordering</span></span></code></pre></div></div></figure>

<ul>
<li>通过部分调用可以简化函数定义（<code>point free style</code>）</li>
</ul>
<figure class="shiki"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki one-dark-pro"><code><span class="line"><span style="color: #abb2bf">foo (&lt;参数&gt;*) = bar b \1  改为 foo = bar b</span></span></code></pre></div></div></figure>

<h5 id="设置中缀函数的fixty和优先级"><a href="#设置中缀函数的fixty和优先级" class="headerlink" title="设置中缀函数的fixty和优先级"></a>设置中缀函数的fixty和优先级</h5><p>优先级设置了就不能再重新设置</p>
<p>由于值构造子也是函数，它也可以设置</p>
<figure class="shiki haskell"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki one-dark-pro"><code><span class="line"><span style="color: #ABB2BF">(infixr|infixl) &lt;priority&gt; &lt;符号函数名&gt; </span><span style="color: #7F848E; font-style: italic">-- 如果是非符号函数，那么需要加上反引号</span></span></code></pre></div></div></figure>

<h4 id="模式"><a href="#模式" class="headerlink" title="模式"></a>模式</h4><p><code>模式匹配</code>：所有的赋值结构以及函数的定义(包括λ表达式)都能进行<code>模式匹配</code></p>
<p><code>值的拆分</code>：模式匹配后，可以进行<code>值的拆分</code>，拆分值：<code>(或[(&lt;name&gt;,)*(或[ = (或[(&lt;exp&gt;,)*(或[</code>，<code>&lt;valueConstructor&gt; &lt;name&gt;* = &lt;exp&gt;</code></p>
<p>调用函数时参数会进行<code>模式匹配</code>，会从上到下进行值的匹配：</p>
<figure class="shiki haskell"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div><div class="code"><pre class="shiki one-dark-pro"><code><span class="line"><span style="color: #61AFEF">f</span><span style="color: #ABB2BF"> :: </span><span style="color: #D19A66">Int</span><span style="color: #ABB2BF"> -&gt; </span><span style="color: #D19A66">Int</span></span>
<span class="line"><span style="color: #ABB2BF">f </span><span style="color: #D19A66">0</span><span style="color: #ABB2BF"> = </span><span style="color: #D19A66">1</span></span>
<span class="line"><span style="color: #ABB2BF">f n = f (n-</span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">) * n</span></span></code></pre></div></div></figure>

<p>还有拆分值的功能</p>
<figure class="shiki haskell"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div><div class="code"><pre class="shiki one-dark-pro"><code><span class="line"><span style="color: #61AFEF">addVectors</span><span style="color: #ABB2BF"> :: (</span><span style="color: #D19A66">Num</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">a</span><span style="color: #ABB2BF">) =&gt; (</span><span style="color: #C678DD">a</span><span style="color: #ABB2BF">, </span><span style="color: #C678DD">a</span><span style="color: #ABB2BF">) -&gt; (</span><span style="color: #C678DD">a</span><span style="color: #ABB2BF">, </span><span style="color: #C678DD">a</span><span style="color: #ABB2BF">) -&gt; (</span><span style="color: #C678DD">a</span><span style="color: #ABB2BF">, </span><span style="color: #C678DD">a</span><span style="color: #ABB2BF">)  </span></span>
<span class="line"><span style="color: #ABB2BF">addVectors (x1, y1) (x2, y2) = (x1 + x2, y1 + y2)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #61AFEF">addVectors</span><span style="color: #ABB2BF"> :: (</span><span style="color: #D19A66">Num</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">a</span><span style="color: #ABB2BF">) =&gt; [</span><span style="color: #C678DD">a</span><span style="color: #ABB2BF">] -&gt; [</span><span style="color: #C678DD">a</span><span style="color: #ABB2BF">] -&gt; [</span><span style="color: #C678DD">a</span><span style="color: #ABB2BF">]</span></span>
<span class="line"><span style="color: #ABB2BF">addVectors [x1, y1] [x2, y2] = [x1 + x2, y1 + y2]</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">-- 不合法</span></span>
<span class="line"><span style="color: #7F848E; font-style: italic">--addVectors ([x1, y1]++_) ([x2, y2]++_) = [x1 + x2, y1 + y2]</span></span>
<span class="line"><span style="color: #7F848E; font-style: italic">-- 括号必须，_也可匹配[]</span></span>
<span class="line"><span style="color: #ABB2BF">addVectors (x1:y1:_) (x2:y2:_) = [x1 + x2, y1 + y2]</span></span>
<span class="line"></span>
<span class="line"><span style="color: #61AFEF">head&#39;</span><span style="color: #ABB2BF"> :: [</span><span style="color: #C678DD">a</span><span style="color: #ABB2BF">] -&gt; </span><span style="color: #C678DD">a</span><span style="color: #ABB2BF">  </span></span>
<span class="line"><span style="color: #ABB2BF">head&#39; </span><span style="color: #D19A66">[]</span><span style="color: #ABB2BF"> = error </span><span style="color: #98C379">&quot;Can&#39;t call head on an empty list, dummy!&quot;</span><span style="color: #ABB2BF">  </span></span>
<span class="line"><span style="color: #ABB2BF">head&#39; (x:_) = x</span></span></code></pre></div></div></figure>

<p>拆分列表值</p>
<figure class="shiki haskell"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div><div class="code"><pre class="shiki one-dark-pro"><code><span class="line"><span style="color: #ABB2BF"># t匹配一个长度为3，最后两个元素是2，3的列表</span></span>
<span class="line"><span style="color: #61AFEF">f</span><span style="color: #ABB2BF"> :: [</span><span style="color: #D19A66">Int</span><span style="color: #ABB2BF">] -&gt; [</span><span style="color: #D19A66">Int</span><span style="color: #ABB2BF">]; f (_:t@(_:</span><span style="color: #D19A66">2</span><span style="color: #ABB2BF">:</span><span style="color: #D19A66">3</span><span style="color: #ABB2BF">:</span><span style="color: #D19A66">[]</span><span style="color: #ABB2BF">)) = </span><span style="color: #D19A66">0</span><span style="color: #ABB2BF">:t; f _ = </span><span style="color: #D19A66">[]</span><span style="color: #ABB2BF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">f [</span><span style="color: #D19A66">2</span><span style="color: #ABB2BF">,</span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">,</span><span style="color: #D19A66">2</span><span style="color: #ABB2BF">,</span><span style="color: #D19A66">3</span><span style="color: #ABB2BF">] == [</span><span style="color: #D19A66">0</span><span style="color: #ABB2BF">,</span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">,</span><span style="color: #D19A66">2</span><span style="color: #ABB2BF">,</span><span style="color: #D19A66">3</span><span style="color: #ABB2BF">]</span></span>
<span class="line"><span style="color: #ABB2BF">f [</span><span style="color: #D19A66">2</span><span style="color: #ABB2BF">,</span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">,</span><span style="color: #D19A66">2</span><span style="color: #ABB2BF">,</span><span style="color: #D19A66">2</span><span style="color: #ABB2BF">] == </span><span style="color: #D19A66">[]</span></span></code></pre></div></div></figure>


<p>列表生成式也有类似的功能</p>
<figure class="shiki haskell"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div><div class="code"><pre class="shiki one-dark-pro"><code><span class="line"><span style="color: #ABB2BF">xs = [(</span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">,</span><span style="color: #D19A66">3</span><span style="color: #ABB2BF">), (</span><span style="color: #D19A66">4</span><span style="color: #ABB2BF">,</span><span style="color: #D19A66">3</span><span style="color: #ABB2BF">), (</span><span style="color: #D19A66">2</span><span style="color: #ABB2BF">,</span><span style="color: #D19A66">4</span><span style="color: #ABB2BF">), (</span><span style="color: #D19A66">5</span><span style="color: #ABB2BF">,</span><span style="color: #D19A66">3</span><span style="color: #ABB2BF">), (</span><span style="color: #D19A66">5</span><span style="color: #ABB2BF">,</span><span style="color: #D19A66">6</span><span style="color: #ABB2BF">), (</span><span style="color: #D19A66">3</span><span style="color: #ABB2BF">,</span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">)]  </span></span>
<span class="line"><span style="color: #ABB2BF">[a+b | (a,b) &lt;- xs]</span></span></code></pre></div></div></figure>
<h4 id="guard"><a href="#guard" class="headerlink" title="guard"></a>guard</h4><p>guard同样是从上到下判断的，只有表达式值为True才会调用。如果都为False那么继续找下一个模式。</p>
<p><code>otherwise = True</code></p>
<figure class="shiki haskell"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div><div class="code"><pre class="shiki one-dark-pro"><code><span class="line"><span style="color: #61AFEF">f</span><span style="color: #ABB2BF"> :: </span><span style="color: #D19A66">Int</span><span style="color: #ABB2BF"> -&gt; </span><span style="color: #D19A66">Int</span></span>
<span class="line"><span style="color: #ABB2BF">f </span><span style="color: #D19A66">0</span><span style="color: #ABB2BF"> = </span><span style="color: #D19A66">1</span></span>
<span class="line"><span style="color: #ABB2BF">f n</span></span>
<span class="line"><span style="color: #ABB2BF">    | n == </span><span style="color: #D19A66">1</span><span style="color: #ABB2BF"> = </span><span style="color: #D19A66">1</span></span>
<span class="line"><span style="color: #ABB2BF">    | n &lt;= </span><span style="color: #D19A66">10</span><span style="color: #ABB2BF"> = f (n-</span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">) * n</span></span>
<span class="line"><span style="color: #ABB2BF">    | otherwise = error (</span><span style="color: #98C379">&quot;n to big: &quot;</span><span style="color: #ABB2BF"> ++ (show n))</span></span></code></pre></div></div></figure>

<h4 id="where"><a href="#where" class="headerlink" title="where"></a>where</h4><p>where定义的量（可以定义名字和函数）只在本模式内可见，并且通过换行或分号分隔</p>
<p>如果有guard，where必须在本模式所有的guard后面</p>
<figure class="shiki haskell"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div><div class="code"><pre class="shiki one-dark-pro"><code><span class="line"><span style="color: #61AFEF">bmiTell</span><span style="color: #ABB2BF"> :: (</span><span style="color: #D19A66">RealFloat</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">a</span><span style="color: #ABB2BF">) =&gt; </span><span style="color: #C678DD">a</span><span style="color: #ABB2BF"> -&gt; </span><span style="color: #C678DD">a</span><span style="color: #ABB2BF"> -&gt; </span><span style="color: #D19A66">String</span><span style="color: #ABB2BF">  </span></span>
<span class="line"><span style="color: #ABB2BF">bmiTell weight height  </span></span>
<span class="line"><span style="color: #ABB2BF">    | bmi &lt;= skinny = </span><span style="color: #98C379">&quot;You&#39;re underweight, you emo, you!&quot;</span><span style="color: #ABB2BF">  </span></span>
<span class="line"><span style="color: #ABB2BF">    | bmi &lt;= normal = </span><span style="color: #98C379">&quot;You&#39;re supposedly normal. Pffft, I bet you&#39;re ugly!&quot;</span><span style="color: #ABB2BF">  </span></span>
<span class="line"><span style="color: #ABB2BF">    | bmi &lt;= fat    = </span><span style="color: #98C379">&quot;You&#39;re fat! Lose some weight, fatty!&quot;</span><span style="color: #ABB2BF">  </span></span>
<span class="line"><span style="color: #ABB2BF">    | otherwise     = </span><span style="color: #98C379">&quot;You&#39;re a whale, congratulations!&quot;</span><span style="color: #ABB2BF">  </span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">where</span><span style="color: #ABB2BF"> bmi = weight / height ^ </span><span style="color: #D19A66">2</span><span style="color: #ABB2BF">  </span></span>
<span class="line"><span style="color: #ABB2BF">          skinny = </span><span style="color: #D19A66">18.5</span><span style="color: #ABB2BF">  </span></span>
<span class="line"><span style="color: #ABB2BF">          normal = </span><span style="color: #D19A66">25.0</span><span style="color: #ABB2BF">  </span></span>
<span class="line"><span style="color: #ABB2BF">          fat = </span><span style="color: #D19A66">30.0</span></span>
<span class="line"><span style="color: #ABB2BF">    或者</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">where</span><span style="color: #ABB2BF"> bmi = weight / height ^ </span><span style="color: #D19A66">2</span><span style="color: #ABB2BF">  </span></span>
<span class="line"><span style="color: #ABB2BF">      (skinny, normal, fat) = (</span><span style="color: #D19A66">18.5</span><span style="color: #ABB2BF">, </span><span style="color: #D19A66">25.0</span><span style="color: #ABB2BF">, </span><span style="color: #D19A66">30.0</span><span style="color: #ABB2BF">)</span></span></code></pre></div></div></figure>

<h4 id="let"><a href="#let" class="headerlink" title="let"></a>let</h4><p>有两种形式：</p>
<ul>
<li>第一种，它是一个表达式，任何能使用表达式的地方都能使用：</li>
</ul>
<figure class="shiki haskell"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div><div class="code"><pre class="shiki one-dark-pro"><code><span class="line"><span style="color: #7F848E; font-style: italic">-- 每个部分必须存在</span></span>
<span class="line"><span style="color: #C678DD">let</span><span style="color: #ABB2BF"> &lt;bindings&gt; </span><span style="color: #C678DD">in</span><span style="color: #ABB2BF"> &lt;expression&gt;</span></span>
<span class="line"><span style="color: #ABB2BF">&lt;bindings&gt;: &lt;binding&gt;[(;|回车)&lt;binding&gt;]*</span></span>
<span class="line"><span style="color: #ABB2BF">&lt;binding&gt;: &lt;name&gt; = &lt;value&gt;</span></span></code></pre></div></div></figure>

<p>let在<code>&lt;bindings&gt;</code>定义的量只在当前<code>let表达式</code>内可见</p>
<p>let表达式的值是<code>&lt;expression&gt;</code>的值</p>
<blockquote>
<p>在函数中使用可以通过换行来分隔binding，此时<code>;</code>可写可不写</p>
</blockquote>
<ul>
<li>第二种，没有<code>in</code>部分，用在<code>do</code>和列表生成式中，用来定义<code>do</code>和列表生成式中的局部的量：</li>
</ul>
<figure class="shiki haskell"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki one-dark-pro"><code><span class="line"><span style="color: #C678DD">let</span><span style="color: #ABB2BF"> &lt;bindings&gt;</span></span></code></pre></div></div></figure>
<blockquote>
<p>如果在<code>ghci</code>命令行中输入，不加<code>in &lt;expression&gt;</code>不是let表达式，相当于在外围定义量</p>
</blockquote>
<h4 id="case-表达式"><a href="#case-表达式" class="headerlink" title="case 表达式"></a>case 表达式</h4><figure class="shiki haskell"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br></pre></div><div class="code"><pre class="shiki one-dark-pro"><code><span class="line"><span style="color: #C678DD">case</span><span style="color: #ABB2BF"> &lt;exp&gt; </span><span style="color: #C678DD">of</span><span style="color: #ABB2BF"> (&lt;pattern&gt; -&gt; &lt;exp&#39;&gt;)+</span></span></code></pre></div></div></figure>

<p>将<code>&lt;exp&gt;</code>的值从上到下进行<code>&lt;pattern&gt;</code>的匹配，匹配成功后返回<code>&lt;exp&#39;&gt;</code>的值</p>
<figure class="shiki haskell"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div><div class="code"><pre class="shiki one-dark-pro"><code><span class="line"><span style="color: #61AFEF">head&#39;</span><span style="color: #ABB2BF"> :: [</span><span style="color: #C678DD">a</span><span style="color: #ABB2BF">] -&gt; </span><span style="color: #C678DD">a</span><span style="color: #ABB2BF">  </span></span>
<span class="line"><span style="color: #ABB2BF">head&#39; </span><span style="color: #D19A66">[]</span><span style="color: #ABB2BF"> = error </span><span style="color: #98C379">&quot;Can&#39;t call head on an empty list, dummy!&quot;</span><span style="color: #ABB2BF">  </span></span>
<span class="line"><span style="color: #ABB2BF">head&#39; (x:_) = x</span></span>
<span class="line"></span>
<span class="line"><span style="color: #7F848E; font-style: italic">-- 可以用分号或者换行分隔</span></span>
<span class="line"><span style="color: #ABB2BF">head&#39; xs = </span><span style="color: #C678DD">case</span><span style="color: #ABB2BF"> xs </span><span style="color: #C678DD">of</span><span style="color: #ABB2BF"> </span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #D19A66">[]</span><span style="color: #ABB2BF"> -&gt; error </span><span style="color: #98C379">&quot;Can&#39;t call head on an empty list, dummy!&quot;</span></span>
<span class="line"><span style="color: #ABB2BF">    (x:_) -&gt; x</span></span></code></pre></div></div></figure>

<h4 id="lambda表达式"><a href="#lambda表达式" class="headerlink" title="lambda表达式"></a>lambda表达式</h4><p>lambda也能进行模式匹配，但是因为它是匿名的，所以只能有一个模式</p>
<p>一般情况下，lambda 都是括在括号中，只要不会产生不平衡的括号，lambda的body会尽可能向右延伸。</p>
<figure class="shiki haskell"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div><div class="code"><pre class="shiki one-dark-pro"><code><span class="line"><span style="color: #61AFEF">addThree</span><span style="color: #ABB2BF"> :: (</span><span style="color: #D19A66">Num</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">a</span><span style="color: #ABB2BF">) =&gt; </span><span style="color: #C678DD">a</span><span style="color: #ABB2BF"> -&gt; </span><span style="color: #C678DD">a</span><span style="color: #ABB2BF"> -&gt; </span><span style="color: #C678DD">a</span><span style="color: #ABB2BF"> -&gt; </span><span style="color: #C678DD">a</span><span style="color: #ABB2BF">  </span></span>
<span class="line"><span style="color: #ABB2BF">addThree = \x -&gt; \y -&gt; \z -&gt; x + y + z</span></span></code></pre></div></div></figure>

<figure class="shiki haskell"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div><div class="code"><pre class="shiki one-dark-pro"><code><span class="line"><span style="color: #61AFEF">flip&#39;</span><span style="color: #ABB2BF"> :: (</span><span style="color: #C678DD">a</span><span style="color: #ABB2BF"> -&gt; </span><span style="color: #C678DD">b</span><span style="color: #ABB2BF"> -&gt; </span><span style="color: #C678DD">c</span><span style="color: #ABB2BF">) -&gt; </span><span style="color: #C678DD">b</span><span style="color: #ABB2BF"> -&gt; </span><span style="color: #C678DD">a</span><span style="color: #ABB2BF"> -&gt; </span><span style="color: #C678DD">c</span><span style="color: #ABB2BF">  </span></span>
<span class="line"><span style="color: #ABB2BF">flip&#39; f = \x -&gt; \y -&gt; f y x</span></span></code></pre></div></div></figure>


<h3 id="module"><a href="#module" class="headerlink" title="module"></a>module</h3><p>ghc中的模块源码<code>.html</code>文件在<code>xxx\Haskell Platform\8.6.5\doc\libraries\base-4.12.0.0\src</code>下</p>
<blockquote>
<p>The module name and the file name must be the same. Otherwise it can’t compile.</p>
</blockquote>
<p>导入模块：</p>
<p>导入一个模块会自动导入所有的instance定义，但是 the instance is only available if the constructor is in scope.</p>
<figure class="shiki"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div><div class="code"><pre class="shiki one-dark-pro"><code><span class="line"><span style="color: #abb2bf">&lt;import&gt;: [qualified] &lt;module&gt; [as] &lt;prefix&gt; [hiding] [&lt;tuple&gt;]</span></span>
<span class="line"><span style="color: #abb2bf">import { &lt;import&gt; }+</span></span>
<span class="line"><span style="color: #abb2bf"></span></span>
<span class="line"><span style="color: #abb2bf">-- 导入全部</span></span>
<span class="line"><span style="color: #abb2bf">import Data.List</span></span>
<span class="line"><span style="color: #abb2bf"></span></span>
<span class="line"><span style="color: #abb2bf">-- 选择性导入，只导入 nub和sort</span></span>
<span class="line"><span style="color: #abb2bf">import Data.List (nub，sort)</span></span>
<span class="line"><span style="color: #abb2bf"></span></span>
<span class="line"><span style="color: #abb2bf">-- 除了 nub 其它全部导入</span></span>
<span class="line"><span style="color: #abb2bf">import Data.List hiding (nub)</span></span>
<span class="line"><span style="color: #abb2bf"></span></span>
<span class="line"><span style="color: #abb2bf">-- 导入全部，引用时需要加上`M.`前缀</span></span>
<span class="line"><span style="color: #abb2bf">import qualified Data.Map as M</span></span>
<span class="line"><span style="color: #abb2bf"></span></span>
<span class="line"><span style="color: #abb2bf">import qualified Data.Map == import qualified Data.Map as Data.Map</span></span></code></pre></div></div></figure>

<p>默认导入了<code>Prelude</code>模块，这个模块仅仅是导入一些其它模块的，然后导出一部分函数。</p>
<h4 id="建立模块"><a href="#建立模块" class="headerlink" title="建立模块"></a>建立模块</h4><figure class="shiki haskell"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div><div class="code"><pre class="shiki one-dark-pro"><code><span class="line"><span style="color: #7F848E; font-style: italic">-- 括号里是需要导出的函数、类型构造子、值构造子、还有typelcass中定义的内容</span></span>
<span class="line"><span style="color: #C678DD">module</span><span style="color: #ABB2BF"> &lt;modlue</span><span style="color: #E5C07B">Name</span><span style="color: #ABB2BF">&gt; [&lt;exports&gt;] </span><span style="color: #C678DD">where</span><span style="color: #ABB2BF"> &lt;code&gt;</span></span>
<span class="line"><span style="color: #ABB2BF">&lt;exports&gt; ::= (? (&lt;functionName&gt;|&lt;type&gt;|&lt;typeclass&gt;|&lt;</span><span style="color: #C678DD">module</span><span style="color: #ABB2BF">&gt;),* )? </span><span style="color: #7F848E; font-style: italic">-- 没有：代表导出此模块中的所有内容，`()`代表都不导出</span></span>
<span class="line"><span style="color: #ABB2BF">&lt;fuction</span><span style="color: #E5C07B">Name</span><span style="color: #ABB2BF">&gt; ::= [^</span><span style="color: #E5C07B">A</span><span style="color: #ABB2BF">-</span><span style="color: #E5C07B">Z</span><span style="color: #ABB2BF">].*</span></span>
<span class="line"><span style="color: #ABB2BF">&lt;module&gt; ::= module &lt;module</span><span style="color: #E5C07B">Name&#39;</span><span style="color: #ABB2BF">&gt; [&lt;exports&gt;] </span><span style="color: #7F848E; font-style: italic">-- 导出&lt;moduleName&gt;中导入的`&lt;moduleName&#39;&gt;`模块的内容</span></span>
<span class="line"><span style="color: #ABB2BF">&lt;typeclass&gt; :: = &lt;typeclass</span><span style="color: #E5C07B">Name</span><span style="color: #ABB2BF">&gt; ( ( &lt;</span><span style="color: #61AFEF">functiomName</span><span style="color: #ABB2BF">&gt;* | </span><span style="color: #E06C75">..</span><span style="color: #ABB2BF"> ) ) </span><span style="color: #7F848E; font-style: italic">-- `()`或者没有：代表不导出内部定义的内容</span></span>
<span class="line"><span style="color: #ABB2BF">&lt;type&gt; ::= &lt;type</span><span style="color: #E5C07B">Constructor</span><span style="color: #ABB2BF">&gt;( (&lt;</span><span style="color: #61AFEF">valueConstructor</span><span style="color: #ABB2BF">&gt;*|..) ) </span><span style="color: #7F848E; font-style: italic">-- `()`或者没有：代表不导出type中的值构造子</span></span>
<span class="line"><span style="color: #ABB2BF">&lt;type</span><span style="color: #E5C07B">Constructor</span><span style="color: #ABB2BF">&gt; | &lt;value</span><span style="color: #E5C07B">Constructor</span><span style="color: #ABB2BF">&gt; ::= [</span><span style="color: #E5C07B">A</span><span style="color: #ABB2BF">-</span><span style="color: #E5C07B">Z</span><span style="color: #ABB2BF">].*</span></span></code></pre></div></div></figure>

<h3 id="I-O"><a href="#I-O" class="headerlink" title="I&#x2F;O"></a>I&#x2F;O</h3><p><code>I/O action</code>（一个函数）代表一个会造成副作用的动作，常是指读取输入或输出到屏幕，同时也代表会回传某些值，类型是<code>IO &lt;type&gt;</code>。</p>
<p>取出值：<code>name &lt;- IO &lt;type&gt;类型的值</code>，name的类型将是<code>&lt;type&gt;</code>。</p>
<p>可以使用<code>do notation</code>将许多I&#x2F;O action打包，最后一个函数的返回值就是整体的返回值，可以使用<code>return</code>函数包装返回值（<code>Monad m =&gt; a -&gt; m a</code>，<code>IO</code>就是一个<code>Monad</code>，它只是个函数不会终止调用它的函数）</p>
<p>例子：</p>
<figure class="shiki haskell"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div><div class="code"><pre class="shiki one-dark-pro"><code><span class="line"><span style="color: #ABB2BF">main = </span><span style="color: #C678DD">do</span></span>
<span class="line"><span style="color: #ABB2BF">    putStrLn </span><span style="color: #98C379">&quot;please enter an number:&quot;</span></span>
<span class="line"><span style="color: #ABB2BF">    run </span><span style="color: #D19A66">33</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">run x = </span><span style="color: #C678DD">do</span></span>
<span class="line"><span style="color: #ABB2BF">    number &lt;- getLine</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> null number</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">then</span><span style="color: #ABB2BF"> return </span><span style="color: #D19A66">()</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">else</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">do</span><span style="color: #ABB2BF"> </span><span style="color: #7F848E; font-style: italic">-- 必须用do打包成一个整体</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #C678DD">let</span><span style="color: #ABB2BF"> num = read number :: </span><span style="color: #D19A66">Int</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> num == x</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #C678DD">then</span><span style="color: #ABB2BF"> putStrLn </span><span style="color: #98C379">&quot;correct!&quot;</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #C678DD">else</span><span style="color: #ABB2BF"> </span><span style="color: #C678DD">do</span></span>
<span class="line"><span style="color: #ABB2BF">            </span><span style="color: #C678DD">if</span><span style="color: #ABB2BF"> num &lt; x</span></span>
<span class="line"><span style="color: #ABB2BF">            </span><span style="color: #C678DD">then</span><span style="color: #ABB2BF"> putStrLn </span><span style="color: #98C379">&quot;less&quot;</span></span>
<span class="line"><span style="color: #ABB2BF">            </span><span style="color: #C678DD">else</span><span style="color: #ABB2BF"> putStrLn </span><span style="color: #98C379">&quot;greater&quot;</span></span>
<span class="line"><span style="color: #ABB2BF">            run x</span></span></code></pre></div></div></figure>

<h4 id="函数-1"><a href="#函数-1" class="headerlink" title="函数"></a>函数</h4><ul>
<li><code>putChar</code>、<code>putStr</code>、<code>putStrLn</code>、<code>print</code>（putStrLn . show）</li>
<li><code>getChar</code>（Enter 被按下的时候才会触发读取字符的行为，回车也会被获取到）</li>
<li><code>getLine</code></li>
</ul>
<h3 id="do"><a href="#do" class="headerlink" title="do"></a>do</h3><p>do notation 是一个语法糖，具体请看：Haskell类型.md 的 Monad 部分</p>
<figure class="shiki haskell"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div><div class="code"><pre class="shiki one-dark-pro"><code><span class="line"><span style="color: #ABB2BF">main = </span><span style="color: #C678DD">do</span><span style="color: #ABB2BF"> putStrLn </span><span style="color: #98C379">&quot;What is your name?&quot;</span></span>
<span class="line"><span style="color: #ABB2BF">          a &lt;- getLine</span></span>
<span class="line"><span style="color: #ABB2BF">          putStrLn </span><span style="color: #98C379">&quot;How old are you?&quot;</span></span>
<span class="line"><span style="color: #ABB2BF">          b &lt;- getLine</span></span>
<span class="line"><span style="color: #ABB2BF">          print (a,b)</span></span>
<span class="line"><span style="color: #ABB2BF"># 解语法糖后：</span></span>
<span class="line"><span style="color: #ABB2BF">main = putStrLn </span><span style="color: #98C379">&quot;What is your name?&quot;</span></span>
<span class="line"><span style="color: #ABB2BF">       &gt;&gt; getLine</span></span>
<span class="line"><span style="color: #ABB2BF">       &gt;&gt;= \a -&gt; putStrLn </span><span style="color: #98C379">&quot;How old are you?&quot;</span></span>
<span class="line"><span style="color: #ABB2BF">       &gt;&gt; getLine</span></span>
<span class="line"><span style="color: #ABB2BF">       &gt;&gt;= \b -&gt; print (a,b)</span></span></code></pre></div></div></figure>

  </div>
  <div class="post-footer">
    

    <a href="#top" class="top">返回顶部</a>
  </div>
  
</article>
<footer>
  &copy; 2024
  <span class="author">
    Iails
  </span>

  <span class="right">
    <!-- <a target="_blank" rel="noopener" href="https://beian.miit.gov.cn">赣ICP备18013550号-1</a> -->
    <a target="_blank" rel="noopener" href="https://github.com/iails01">Github</a>
  </span>
</footer>

    </div>
  <!-- hexo injector body_end start -->
<script src="https://cdn.jsdelivr.net/npm/hexo-shiki-plugin@latest/lib/codeblock.js"></script>

  <script>
  const CODE_CONFIG = {
    beautify: true,
    highlightCopy: true,
    highlightLang: true,
    highlightHeightLimit: 360,
    isHighlightShrink: false,
    copy: {
      success: 'Copy Success',
      error: 'Copy Error',
      noSupport: 'Browser Not Support',
    }
  };
  console.log(
    `%c hexo-shiki-plugin %c v1.0.26 %c https://github.com/nova1751/hexo-shiki-plugin`,
    "color: #fff; background: #5f5f5f",
    "color: #fff; background: #80c8f8",
    ""
  );
  </script>
  <!-- hexo injector body_end end --></body>
</html>